'use strict';
 angular.module('app')
 .factory('GeoList', function ($q) {

    var GeoList = Parse.Object.extend('GeoList', {}, {

      create: function (geolist) {

        var defer = $q.defer();
        var objGeoList = new GeoList();

        objGeoList.save(geolist, {
          success: function (obj) {
            defer.resolve(obj);
          }, error: function (obj, error) {
            defer.reject(error);
          }
        });

        return defer.promise;
      },

      update: function (geolist) {

        var defer = $q.defer();

        geolist.save(null, {
          success: function (obj) {
            defer.resolve(obj);
          }, error: function (obj, error) {
            defer.reject(error);
          }
        });

        return defer.promise;
      },

      destroy: function (geolistId) {

        var defer = $q.defer();

        var geolist = new GeoList();
        geolist.id = geolistId;

        geolist.destroy({
          success: function (obj) {
            defer.resolve(obj);
          }, error: function (obj, error) {
            defer.reject(error);
          }
        });

        return defer.promise;
      },

      count: function (params) {

        var defer = $q.defer();

        var query = new Parse.Query(this);

        if (params.filter != '') {
          query.contains('canonical', params.filter);
        }

        query.count({
          success: function (count) {
            defer.resolve(count);
          },
          error: function (error) {
            defer.reject(error);
          }
        });

        return defer.promise;

      },

      all: function (params) {

        var defer = $q.defer();

        var query = new Parse.Query(this);

        if (params.filter != '') {
          query.contains('canonical', params.filter);
        }

        if (params.order === 'order') {
          query.ascending('order');
        } else if (params.order === '-order') {
          query.descending('order');
        } else {
          query.ascending('order');
        }

        query.limit(params.limit);
        query.skip((params.page * params.limit) - params.limit);
        query.find({
          success: function (categories) {
            defer.resolve(categories);
          }, error: function (error) {
            defer.reject(error);
          }
        });

        return defer.promise;

      },

    });

    Object.defineProperty(GeoList.prototype, 'title',
    {
      get: function () {
        return this.get('title');
      },
      set: function (val) {
        this.set('title', val);
      }
    });

    Object.defineProperty(GeoList.prototype, 'message',
    {
      get: function () {
        return this.get('message');
      },
      set: function (val) {
        this.set('message', val);
      }
    });

    

    Object.defineProperty(GeoList.prototype, 'icon',
    {
      get: function () {
        return this.get('icon');
      },
      set: function (val) {
        this.set('icon', val);
      }
    });

    Object.defineProperty(GeoList.prototype, 'order',
    {
      get: function () {
        return this.get('order');
      },
      set: function (val) {
        this.set('order', val);
      }
    });

      Object.defineProperty(GeoList.prototype, 'radius', {
        get: function () {
            return this.get('radius');
        },
        set: function (value) {
            this.set('radius', value);
        }
    });

   Object.defineProperty(GeoList.prototype, 'location', {
        get: function () {
            return this.get('location');
        },
        set: function (val) {
            this.set('location', new Parse.GeoPoint({
                latitude: val.latitude,
                longitude: val.longitude
            }));
        }
    });


return GeoList;

});
